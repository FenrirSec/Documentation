# Fenrir Pentest Methodology


## The 6 Phases

- Pre-engagement
- Intelligence Gathering (Reconnaissance)
<!-- - Threat Modeling (Assessment) ? -->
- Scanning
- Exploitation
- Post Exploitation
- Reporting

---


## Pre Engagement

### Hardware

#### Wi-Fi Adapter Supporting packet injection
- TPLink Adapter

### Software

#### Infrastructure

- VMware
- Virtualbox
- QEMU/KVM
    - Windows 10 VM
    - Kali/Blackarch/ParrotOS VM

#### Assessment

- Maltego - Maltego is an interactive data mining tool that renders directed graphs for link analysis.
- Metasploit Framework - collection of remote exploits and post exploitation tools for all platforms
- SET toolkit - designed to perform advanced attacks against the human element.
- theHarvester - gathering e-mail accounts, user names and hostnames/subdomains from different public sources
- mimikat - extract plain or hash of password.
- dig - bind-utils
- THC Hydra - for brute force
- Powersploit - a collection of Microsoft PowerShell modules
- CrackmapExec - post exploitation tools for Active Directory.
- Burpsuite - can use as proxy as well as active scanner
- Empire - powershell framework for remote and post exploitation.
- Nmap - port scanner
- knockpy - subdomain scanner
- netcat - network utility
- nishang - post exploitation powershell Framework

(more on https://github.com/FenrirSec/fenrir-tools)

### Checklist

- [ ] Determination of the type of pentest (Blackbox, Whitebox)
- [ ] Key objectives behind this penetration test
- [ ] Location address and contact (if it is an onsite job)
- [ ] Validation that the Authorization Letter has been signed
- [ ] URL of the web application that is in scope and validation that isaccessible
- [ ]  2 sets of credentials (normal and admin or a privilege user) and validation that are working
- [ ] Determination of the environment (Production or UAT)
- [ ] Number of static and dynamic pages
- [ ] Testing Boundaries (DoS, Brute force attacks etc.)
- [ ] Technologies (PHP, ASP, .NET, IIS, Apache, Operating system etc.)
- [ ] Any VPN or port numbers are needed and verify those ahead of time
- [ ] Any web services that the site may use.
- [ ] Any pages that the client does not want to be tested.
- [ ] Any pages that submit emails
- [ ] IP address of the tester
- [ ] Escalation contact
- [ ] 3rd parties that needs to be contacted in advance of the pentest
- [ ] Web application firewalls and other IDS in place
- [ ] Timeframe of the assessment (dates and hours)
- [ ] Diagrams and any kind of documentation
- [ ] Validation that a backup has been performed recently on theapplication
- [ ] Other client requirements

---

## Intelligence Gathering

- whois enumeration
- ip search on Bing (ip:{IP})
- Domain profiling
    - https://www.robtex.com/dns-lookup/fenrir.pro
    - https://frbin.com/fenrir.pro
- SubDomain Enumeration
- Spidering + Local Copy
- 
Certificates transparency enumeration
    - https://securitytrails.com/list/apex_domain/fenrir.agency
- WaybackMachine Archives
- Google -> cache:https://fenrir.pro
- Google -> jobs fenrir.pro
- Emails : hunter.io (Have a look at the email sources also)
- HaveIBeenPwned -> Check breachcompilations
- IntelX.io (tous les outils necessaires)
- Visiting the website behing Tor/VPN
    - Wappalyzer
- Traffic Analysis
    - alexa
    - similarweb
    - semrush
- https://osint.link/
- shodan.io
- censys.io
- https://tools.kali.org/information-gathering/metagoofil
- public files (https://intelx.io/tools?tab=file), site:drive.google.com "target"
- Check Facebook, Twitter "target leaks" "target security" on Twitter
- https://www.searchftps.net/
- https://publicwww.com/
- https://www.thingful.net
- wigle.net
- https://www.social-searcher.com/search-users/?ntw=&q6=lp1eu
### Ressources 

- https://osintframework.com/
- https://github.com/sameera-madushan/Mail-Swipe
---

## Scanning

### Automatic Vuln scanners
- Accunetix
- OpenVas
- Vega
- Nikto
- Wikto
- w3af
- Xenotix XSS Framework
- Wapiti
- https://github.com/projectdiscovery/httpx (HTTP)

### Manual Scanner
- nmap
- Metaploit Framework


### SSL scanners

- testssh.sh
- sslscan

### Guides
- https://resources.infosecinstitute.com/author/revers3r/

### Credential Spraying
- Office 365 https://github.com/0xZDH/o365spray
---

## Exploitation

---

### Windows Evasion

https://jxy-s.github.io/herpaderping/

### Initial Intrusion

- https://www.exploit-db.com/
- https://gchq.github.io/CyberChef/
- http://blog.safebuff.com/2016/06/19/Reverse-shell-Cheat-Sheet/

- https://github.com/mlgualtieri/NTLMRawUnhide

## Wapp/API Testing

- Account creation
- Account activation
- Login
    - https://www.kitploit.com/2020/10/jwt-hack-tool-to-endecoding-jwt.html
- Account modification
- Phone number verification
- Password reset
- https://medium.com/@parasarora06/automating-xss-identification-with-dalfox-paramspider-e14283bb7916

## WiFI

- https://sensepost.com/blog/2020/pass-the-hash-wifi/

---

## Post Exploitation

### Windows

https://www.infosecmatter.com/powershell-commands-for-pentesters/
- Windows sysinternals `net use Z: https://live.sysinternals.com`

#### Password dumping
- TBAL DPAIP Backdoor for local user
- Dumping Domain Password
- Dumping ClearText Creds
- Empire Tips and Trick
- Extract Remote Hash
- Capturing NetNTML
#### AD
- The worst of both worlds
- pass-the-hash-is-dead-long-live-localaccounttokenfilterpolicy
- Beyond LLMNR/NBNS Spoofing
- Gathering AD Data with Powershell
- kerberosting without mimikatz
- Kerberost
- Golden Ticket
- pass-the-ticket
- Gaining Domain Admin Rights
- Attacking Kerberos : kicking the guard dog of hades
- Token Impersonation

#### Privilege Escalation
- https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite
- Windows Privilege Escalation Fundamentals by FuzzySecurity
- DLL Hijacking
- Potato
- RottenPotatoNG
- Privilege Escalation Guide
- Lateral Movement
- RDP tunneling
- SQL Server Link Crawling
- Lateral Movement WinRM
- CrackeMapExec
- RDP Inception
- RDP Lateral Movement
- Powerview and crackmapExec
- Persistent payload
- port forwarding with netsh
- The Trustpocalypse
- DcShadow Explained
- Domain Trust: Why You Should Care
- A Guide to Attacking Domain Trusts
- Javascript C2

#### Bypass techniques
- evading autorun
- mimikatz obfuscation
- Putting data in Alternate data streams and how to execute it
- Leveraging INF-SCT Fetch
- Empire without powershell
- Powershell without powershell
- Exploitation Code Injection 
- Powershell to bypass Constraint mode
- Bypass Constraint Mode with runscripthelper
- InternetExplorer.Application for C2
- We Don't Need Powershell.exe Part 2
- WSH Injection

#### SMISC
- Borrowing Microsoft Code Signing Certificates
- Guide to Attacking Domain Trust

### Linux
#### Privilege Escalation
- Basic Linux Privilge escalation by g0tmi1k
- Exploit Database
- Attack and Defend : Linux Privilege Escalation
- SUID executable
- Guide to Linux Privilege Escaltion
- LDAP
- Understand and Exploit web based LDAP
- Web based LDAP injection
- Lateral Movement
- SSH port forwarding
- SSH & meterpreter port forward
- Tunneling & port forwarding
#### Web Shell
- webshell
- p0wny

#### Data Exfil
- awesome-red-teaming
- out of band Exploitation



---
## Reporting

- https://www.sans.org/reading-room/whitepapers/bestprac/writing-penetration-testing-report-33343
- https://github.com/juliocesarfort/public-pentesting-reports
- https://resources.infosecinstitute.com/kali-reporting-tools/#gref
---

## Ressources

- https://github.com/kyawthiha7/pentest-methodology
- http://www.pentest-standard.org/index.php/Pre-engagement
- https://www.owasp.org/index.php/Penetration_testing_methodologies
- https://resources.infosecinstitute.com/penetration-testing-methodologies-and-standards/
- https://www.pentestpeople.com/penetration-testing-methodology/
